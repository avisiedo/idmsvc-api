---
openapi: 3.0.2
info:
    title: hmsidm-backend
    version: 1.0.0
    description: Backend API for hmsidm service
    contact: {}
servers:
    - url: "{schema}://{domain}:{port}{prefix}"
      description: Prod environment
      variables:
          schema:
              default: https
              description: Schema used to reach out the API
          domain:
              default: console.redhat.com
              description: The domain where our API is running
          port:
              default: "443"
              description: The port where our public API is listening
          prefix:
              default: /api/hmsidm/v1
              description: The prefix for our public API
    - url: "{schema}://{domain}:{port}{prefix}"
      description: Prod Beta environment
      variables:
          schema:
              default: https
              description: Schema used to reach out the API
          domain:
              default: console.redhat.com
              description: The domain where our API is running
          port:
              default: "443"
              description: The port where our public API is listening
          prefix:
              default: /beta/api/hmsidm/v1
              description: The prefix for our public API
    - url: "{schema}://{domain}:{port}{prefix}"
      description: Stage environment
      variables:
          schema:
              default: https
              description: Schema used to reach out the API
          domain:
              default: console.stage.redhat.com
              description: The domain where our API is running
          port:
              default: "443"
              description: The port where our public API is listening
          prefix:
              default: /api/hmsidm/v1
              description: The prefix for our public API
    - url: "{schema}://{domain}:{port}{prefix}"
      description: Development environment
      variables:
          schema:
              default: http
              description: Schema used to reach out the API
          domain:
              default: localhost
              description: The domain where our API is running
          port:
              default: "8000"
              description: The port where our public API is listening
          prefix:
              default: /api/hmsidm/v1
              description: The prefix for our public API
paths:
    "/domains/{uuid}":
        summary: Operations on a specific domain
        description: Specific operations on an existing domain to read, update or delete
            it.
        get:
            tags:
                - resources
            responses:
                "200":
                    $ref: "#/components/responses/ReadDomainResponse"
                "400":
                    $ref: "#/components/responses/ErrorResponse"
                "404":
                    $ref: "#/components/responses/ErrorResponse"
            security:
                - x-rh-identity: []
            operationId: readDomain
            summary: Read a domain.
            description: Request the information for a specific domain of our organization.
        delete:
            tags:
                - resources
            responses:
                "204":
                    description: Returned when the resource was deleted.
                "400":
                    $ref: "#/components/responses/ErrorResponse"
                "404":
                    $ref: "#/components/responses/ErrorResponse"
            security:
                - x-rh-identity: []
            operationId: deleteDomain
            summary: Delete domain.
            description: Delete an existing domain from the current organization.
        parameters:
            - name: X-Rh-Identity
              description: Identity header for the request
              schema:
                  type: string
              in: header
              required: true
            - name: X-Rh-Insights-Request-Id
              description: Request id for distributed tracing.
              schema:
                  type: string
              in: header
              required: false
            - examples:
                  a random uuid generated by 'uuid' command:
                      value: '"2e8ce5a6-b370-11ed-9330-482ae3863d30"'
              name: uuid
              description: The uuid that identify the domain.
              schema:
                  type: string
              in: path
              required: true
    "/check-host/{subscription_manager_id}/{fqdn}":
        post:
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: "#/components/schemas/CheckHosts"
                required: true
            tags:
                - actions
            responses:
                "204":
                    description: The enroll of the host vm can be made.
                "400":
                    $ref: "#/components/responses/ErrorResponse"
                "404":
                    $ref: "#/components/responses/ErrorResponse"
            security:
                - x-rh-identity: []
            operationId: checkHost
            summary: Check a host vm before auto-enroll into the domain.
            description: Called from the ipa server to check a host can be enrolled into the
                domain.
        parameters:
            - examples:
                  A random uuid generated from the terminal by 'uuid':
                      value: '"2e8ce5a6-b370-11ed-9330-482ae3863d30"'
              name: subscription_manager_id
              description: The subscription manager id.
              schema:
                  type: string
              in: path
              required: true
            - examples:
                  An example fqdn for a host.:
                      value: '"host1.domain.example"'
              name: fqdn
              description: The full qualified domain name for the host.
              schema:
                  type: string
              in: path
              required: true
            - name: X-Rh-Identity
              description: Identity header.
              schema:
                  type: string
              in: header
              required: true
            - name: X-Rh-Insights-Request-Id
              description: Request id for distributed tracing.
              schema:
                  type: string
              in: header
              required: false
    "/host-conf/{fqdn}":
        summary: Autoenroll host vm endpoint.
        description: Endpoint used by host vm for auto-enrollment.
        post:
            requestBody:
                description: Required information to take the action.
                content:
                    application/json:
                        schema:
                            $ref: "#/components/schemas/HostConf"
                        examples:
                            demo request:
                                value:
                                    fqdn: host1.domain.example
                                    subscription_manager_id: c3ac4b91-27cc-422c-a283-42aadfe730af
                required: true
            tags:
                - actions
            responses:
                "200":
                    $ref: "#/components/responses/HostConfResponse"
            security:
                - x-rh-identity: []
            operationId: hostConf
            summary: Get host vm information.
            description: Action to retrieve the host information for the host vm being
                enrolled.
        parameters:
            - name: X-Rh-Identity
              description: The identity header of the request.
              schema:
                  type: string
              in: header
              required: true
            - name: X-Rh-Insights-Request-Id
              description: Unique request id for distributing tracing.
              schema:
                  type: string
              in: header
              required: false
            - name: fqdn
              description: The full qualified domain name of the host.
              schema:
                  type: string
              in: path
              required: true
    /domains:
        summary: Domain resource
        description: It store the necessary information about a domain that will let
            manage them
        get:
            tags:
                - resources
            parameters:
                - examples:
                      Default offset:
                          value: 0
                      Page 2 for pages of 10 items:
                          value: 10
                  name: offset
                  description: pagination offset
                  schema:
                      type: integer
                  in: query
                  required: false
                - examples:
                      Default value:
                          value: 10
                      15 items per page:
                          value: 15
                  name: limit
                  description: Number of items per page
                  schema:
                      type: integer
                  in: query
                  required: false
            responses:
                "200":
                    $ref: "#/components/responses/ListDomainsResponse"
                "400":
                    $ref: "#/components/responses/ErrorResponse"
                "404":
                    $ref: "#/components/responses/ErrorResponse"
            security:
                - x-rh-identity: []
            operationId: listDomains
            summary: List domains in the organization
            description: |-
                For the current organization, list all the domains that
                are being managed from console.dot
        post:
            requestBody:
                description: Domain object to be created.
                content:
                    application/json:
                        schema:
                            $ref: "#/components/schemas/CreateDomain"
                required: true
            tags:
                - resources
            responses:
                "201":
                    $ref: "#/components/responses/CreateDomainResponse"
                "400":
                    $ref: "#/components/responses/ErrorResponse"
                "404":
                    $ref: "#/components/responses/ErrorResponse"
            security:
                - x-rh-identity: []
            operationId: createDomain
            summary: Create a domain.
            description: Create a domain in the current organization.
        parameters:
            - name: X-Rh-Identity
              description: Identity header for the request
              schema:
                  type: string
              in: header
              required: true
            - name: X-Rh-Insights-Request-Id
              description: Request id for distributed tracing.
              schema:
                  type: string
              in: header
              required: false
    "/domains/{uuid}/register":
        summary: Register domain information throw the ipa-hcc agent.
        description: First registration to update the IPA domain information.
        put:
            requestBody:
                description: Information for an IPA domain so it is updated from the ipa-hcc
                    agent.
                content:
                    application/json:
                        schema:
                            $ref: "#/components/schemas/RegisterDomain"
                required: true
            tags:
                - actions
            responses:
                "200":
                    $ref: "#/components/responses/RegisterDomainResponse"
                "400":
                    $ref: "#/components/responses/ErrorResponse"
                "403":
                    $ref: "#/components/responses/ErrorResponse"
                "404":
                    $ref: "#/components/responses/ErrorResponse"
            security:
                - x-rh-identity: []
            operationId: registerDomain
            summary: Update a domain.
            description: |-
                Use the one time use token to update the initial information for
                a rhel-idm domain.
        parameters:
            - name: X-Rh-Identity
              description: Identity header
              schema:
                  type: string
              in: header
              required: true
            - name: X-Rh-Insights-Request-Id
              description: Request id
              schema:
                  type: string
              in: header
              required: true
            - name: X-Rh-Idm-Registration-Token
              description: One time use token to register ipa information.
              schema:
                  type: string
              in: header
              required: true
            - examples:
                  uuid:
                      value: 08363cd4-bea8-11ed-b83f-482ae3863d30
              name: uuid
              description: uuid for the IPA domain.
              schema:
                  type: string
              in: path
              required: true
            - name: X-Rh-Idm-Version
              description: ipa-hcc agent version
              schema:
                  type: string
              in: header
              required: true
    "/domains/{uuid}/update":
        summary: Update domain information throw the ipa-hcc agent.
        description: Update the rhel-idm domain information.
        put:
            requestBody:
                description: Information for an IPA domain so it is updated from the ipa-hcc
                    agent.
                content:
                    application/json:
                        schema:
                            $ref: "#/components/schemas/UpdateDomain"
                required: true
            tags:
                - actions
            responses:
                "200":
                    $ref: "#/components/responses/UpdateDomainResponse"
                "400":
                    $ref: "#/components/responses/ErrorResponse"
                "403":
                    $ref: "#/components/responses/ErrorResponse"
                "404":
                    $ref: "#/components/responses/ErrorResponse"
            security:
                - x-rh-identity: []
            operationId: updateDomain
            summary: Update a previously registered domain.
            description: Update the initial information for a rhel-idm domain.
        parameters:
            - name: X-Rh-Identity
              description: Identity header
              schema:
                  type: string
              in: header
              required: true
            - name: X-Rh-Insights-Request-Id
              description: Request id
              schema:
                  type: string
              in: header
              required: true
            - examples:
                  uuid:
                      value: 08363cd4-bea8-11ed-b83f-482ae3863d30
              name: uuid
              description: uuid for the IPA domain.
              schema:
                  type: string
              in: path
              required: true
            - name: X-Rh-Idm-Version
              description: ipa-hcc agent version
              schema:
                  type: string
              in: header
              required: true
components:
    schemas:
        Error:
            title: Root Type for Error
            description: General error schema
            required:
                - id
                - status
                - title
                - details
            type: object
            properties:
                id:
                    description: A unique identifier for this particular occurrence of the problem.
                    type: string
                    example: kjuadsfuashwe898w9jf
                status:
                    description: The HTTP status code applicable to this problem, expressed as a
                        string value. This SHOULD be provided.
                    maximum: 599
                    minimum: 100
                    maxLength: 3
                    minLength: 3
                    type: integer
                    readOnly: true
                    example: "400"
                title:
                    description: A human-readable short explanation specific to this occurrence of
                        the problem. This field’s value can be localized.
                    type: string
                    example: Bad request
                details:
                    description: A detailed explanation specific to this occurrence of the problem,
                        e.g. a traceback.
                    type: string
                    example: An error occured at code.go:123.
            example:
                id: ${X-RH-INSIGHTS-REQUEST-ID}
                status: "400"
                detail: "Bad request: additional details: more additional details"
        PaginationMeta:
            title: Root Type for PaginationMeta
            description: Metadata for the paginated responses.
            required:
                - count
                - limit
                - offset
            type: object
            properties:
                count:
                    format: int64
                    description: total records in the collection.
                    type: integer
                    readOnly: false
                    example: "1"
                limit:
                    description: Number of items per page.
                    type: integer
                    readOnly: false
                offset:
                    description: Initial record of the page.
                    type: integer
                    readOnly: false
            additionalProperties: false
            example:
                count: 1
                limit: 10
                offset: 0
        PaginationLinks:
            title: Root Type for PaginationLinks
            description: Represent the navigation links for the data paginated.
            type: object
            properties:
                first:
                    description: Reference to the first page of the request.
                    type: string
                last:
                    description: Reference to the last page of the request.
                    type: string
                next:
                    description: Reference to the next page of the request.
                    type: string
                previous:
                    description: Reference to the previous page of the request.
                    type: string
            additionalProperties: false
            example:
                first: /api/idm/v1/domains?limit=10&offset=0
                last: /api/idm/v1/domains?limit=10&offset=10
                next: /api/idm/v1/domains?limit=10&offset=10
                previous: /api/idm/v1/domains?limit=10&offset=0
        ListDomainsData:
            title: Root Type for ListDomainsData
            description: The data listed for the domains.
            required:
                - auto_enrollment_enabled
                - domain_name
                - domain_type
                - domain_uuid
                - title
                - description
            type: object
            properties:
                domain_uuid:
                    type: string
                domain_name:
                    type: string
                domain_type:
                    enum:
                        - rhel-idm
                    type: string
                auto_enrollment_enabled:
                    type: boolean
                title:
                    description: Human-friendly title for the domain entry.
                    type: string
                description:
                    description: Human-readable description of the domain entry.
                    type: string
            additionalProperties: false
            example:
                domain_uuid: 1aa15eae-a88b-11ed-a2cb-482ae3863d30
                domain_name: mydomain.example
                domain_type: rhel-idm
                auto_enrollment_enabled: true
        HostConf:
            title: Root Type for HostConf
            description: Represent the request payload for the /hostconf/:fqdn endpoint.
            type: object
            properties:
                fqdn:
                    description: The full qualified domain name of the host vm that is being
                        enrolled.
                    type: string
                    example: '"myhost.domain.example"'
                subscription_manager_id:
                    description: The id for the subscription manager.
                    type: string
                    example: '"c3ac4b91-27cc-422c-a283-42aadfe730af"'
            example:
                fqdn: host1.domain.example
                subscription_manager_id: c3ac4b91-27cc-422c-a283-42aadfe730af
        CheckHosts:
            title: Root Type for CheckHosts
            description: >-
                Define the input data for the /check_host action.


                This action is launched from the ipa server to check the host that is being

                auto-enrolled.
            required:
                - inventory_id
                - domain_type
                - domain_name
                - subscription_manager_id
            type: object
            properties:
                domain_name:
                    description: The domain name where to enroll the host vm.
                    type: string
                    example: '"domain.example"'
                domain_type:
                    description: Indicate the type of domain. Actually only ipa is supported.
                    type: string
                    example: '"rhel-idm"'
                subscription_manager_id:
                    description: The subscription manager id for auto-enroll the host vm.
                    type: string
                    example: '"2326738a-adf8-11ed-af7d-482ae3863d30"'
                inventory_id:
                    description: The id of the host vm into the insight host inventory.
                    type: string
                    example: '"2ea6db7e-cf74-4560-a286-4d7c9eaf698f"'
            example:
                domain_name: domain.example
                domain_type: rhel-idm
                subscription_manager_id: 2326738a-adf8-11ed-af7d-482ae3863d30
                inventory_id: 2ea6db7e-cf74-4560-a286-4d7c9eaf698f
        HostConfResponseSchema:
            title: Root Type for HostConfResponse
            description: >-
                The response for the action to retrieve the host vm information
                when

                it is being enrolled. This action is taken from the host vm.
            type: object
            properties:
                domain_name:
                    type: string
                domain_type:
                    type: string
                ipa:
                    type: object
                    properties:
                        realm_name:
                            type: string
                        ca_cert:
                            type: string
                        server_list:
                            type: array
                            items:
                                type: string
            example:
                domain_name: domain.example
                domain_type: rhel-idm
                rhel-idm:
                    realm_name: DOMAIN.EXAMPLE
                    ca_cert: |
                        -----BEGIN CERTIFICATE-----
                        MII...
                        -----END CERTIFICATE-----
                    server_list:
                        - ipaserver.domain.example
        CreateDomainIpaCert:
            title: Root Type for CreateDomainIpaCert
            description: Represent a certificate item in the cacerts list for the Ipa domain
                type.
            type: object
            properties:
                nickname:
                    type: string
                issuer:
                    type: string
                subject:
                    type: string
                serial_number:
                    type: string
                not_valid_before:
                    format: date-time
                    type: string
                not_valid_after:
                    format: date-time
                    type: string
                pem:
                    type: string
            additionalProperties: false
        ListDomainsResponseSchema:
            title: Root Type for ListDomains
            description: Represent a paginated result for a list of domains
            required:
                - meta
                - data
                - links
            type: object
            properties:
                meta:
                    $ref: "#/components/schemas/PaginationMeta"
                links:
                    $ref: "#/components/schemas/PaginationLinks"
                data:
                    description: The content for this page.
                    type: array
                    items:
                        $ref: "#/components/schemas/ListDomainsData"
            additionalProperties: false
            example:
                meta:
                    count: 1
                links:
                    first: /api/idm/v1/domains?limit=10&offset=0
                    last: /api/idm/v1/domains?limit=10&offset=10
                    next: /api/idm/v1/domains?limit=10&offset=10
                    previous: /api/idm/v1/domains?limit=10&offset=0
                data:
                    - domain_uuid: 1aa15eae-a88b-11ed-a2cb-482ae3863d30
                      domain_name: mydomain.example
                      domain_type: rhel-idm
                      auto_enrollment_enabled: true
        CreateDomain:
            title: Root Type for DomainResponse
            description: A domain resource
            required:
                - auto_enrollment_enabled
                - domain_type
                - description
                - title
            type: object
            properties:
                auto_enrollment_enabled:
                    description: Enable or disable host vm auto-enrollment for this domain
                    type: boolean
                    example: "true"
                domain_type:
                    description: Type of this domain. Currently only rhel-idm is supported.
                    enum:
                        - rhel-idm
                    type: string
                    example: rhel-idm
                title:
                    description: the title for the entry
                    type: string
                description:
                    description: Human readable description for this domain.
                    type: string
                    example: This is my awesome domain description.
            additionalProperties: false
            example:
                title: My Domain Example Title
                description: My Domain Example Description
                auto_enrollment_enabled: true
                type: rhel-idm
        CreateDomainIpa:
            title: Root Type for ResponseIpaObject
            description: Options for ipa domains
            required:
                - ca_certs
                - realm_name
                - realm_domains
            type: object
            properties:
                servers:
                    description: List of auto-enrollment enabled servers for this domain.
                    type: array
                    items:
                        $ref: "#/components/schemas/CreateDomainIpaServer"
                    example: '["server1.mydomain.example","server2.mydomain.example"]'
                ca_certs:
                    description: A base64 representation of all the list of chain of certificates,
                        including the server ca.
                    type: array
                    items:
                        $ref: "#/components/schemas/CreateDomainIpaCert"
                    example: >-
                        [
                          {
                            "nickname": "MYDOMAIN.EXAMPLE IPA CA",
                            "issuer": "CN=Certificate Authority,O=MYDOMAIN.EXAMPLE",
                            "subject": "CN=Certificate Authority,O=MYDOMAIN.EXAMPLE",
                            "serial_number": "1",
                            "not_valid_before": "2023-01-31T13:23:36Z",
                            "not_valid_after": "2023-01-31T13:23:36Z",
                            "pem": "-----BEGIN CERTIFICATE-----\nMII...\n-----END CERTIFICATE-----\n"
                          }
                        ]
                realm_name:
                    description: The kerberos realm name associated to the IPA domain.
                    type: string
                    example: MYDOMAIN.EXAMPLE
                realm_domains:
                    description: TODO What is the meaning of this field.
                    type: array
                    items:
                        type: string
            additionalProperties: false
        RegisterDomain:
            title: Root Type for DomainResponse
            description: A domain resource
            type: object
            allOf:
                - type: object
                - $ref: "#/components/schemas/Domain"
            additionalProperties: false
        Errors:
            title: Root Type for ErrorResponse
            description: General error response returned by the hmsidm API
            type: object
            properties:
                errors:
                    description: Error objects provide additional information about problems
                        encountered while performing an operation.
                    minItems: 1
                    type: array
                    items:
                        $ref: "#/components/schemas/Error"
                    readOnly: true
                    example: >
                        [
                          {
                            "id": "${X-RH-INSIGHTS-REQUEST-ID}",
                            "status": "400",
                            "detail": "Bad request: additional details: more additional details"
                          }
                        ]
            example:
                errors:
                    - id: ${X-RH-INSIGHTS-REQUEST-ID}
                      status: "400"
                      detail: "Bad request: additional details: more additional details"
        CreateDomainIpaServer:
            title: Root Type for CreateDomainIpaServer
            description: Server schema for an entry into the Ipa domain type
            required:
                - fqdn
                - ca_server
                - hcc_enrollment_server
                - hcc_update_server
                - pkinit_server
                - subscription_manager_id
            type: object
            properties:
                fqdn:
                    type: string
                    example: server1.mydomain.example
                ca_server:
                    type: boolean
                    example: "true"
                subscription_manager_id:
                    type: string
                    example: 03965a2c-bd24-11ed-968d-482ae3863d30
                hcc_enrollment_server:
                    type: boolean
                    example: "true"
                hcc_update_server:
                    type: boolean
                    example: "true"
                pkinit_server:
                    type: boolean
                    example: "true"
            additionalProperties: false
            example:
                fqdn: ipaserver.mydomain.example
                subscription_manager_id: 03965a2c-bd24-11ed-968d-482ae3863d30
                ca_server: true
                hcc_enrollment_server: true
                hcc_update_server: true
                pkinit_server: true
        DomainIpaCert:
            title: Root Type for CreateDomainIpaCert
            description: Represent a certificate item in the cacerts list for the Ipa domain
                type.
            required:
                - issuer
                - nickname
                - not_valid_after
                - not_valid_before
                - pem
                - serial_number
                - subject
            type: object
            properties:
                nickname:
                    type: string
                    example: MYDOMAIN.EXAMPLE IPA CA
                issuer:
                    type: string
                    example: CN=Certificate Authority,O=MYDOMAIN.EXAMPLE
                subject:
                    type: string
                    example: CN=Certificate Authority,O=MYDOMAIN.EXAMPLE
                serial_number:
                    type: string
                    example: "1"
                not_valid_before:
                    format: date-time
                    type: string
                    example: ""
                not_valid_after:
                    format: date-time
                    type: string
                    example: ""
                pem:
                    type: string
                    example: -----BEGIN CERTIFICATE-----\nMII...\n-----END CERTIFICATE-----\n
            additionalProperties: false
        RhelIdmToken:
            title: Root Type for RhelIdmToken
            description: Represent a rhel-idm token which allow register the domain
                information.
            type: object
            properties:
                secret:
                    type: string
                expiration:
                    format: date-time
                    type: string
        Domain:
            title: Root Type for DomainResponse
            description: A domain resource
            required:
                - auto_enrollment_enabled
                - domain_name
                - domain_type
                - domain_uuid
                - description
                - title
            type: object
            properties:
                domain_uuid:
                    description: Internal id for this domain
                    type: string
                    example: 1aa15eae-a88b-11ed-a2cb-482ae3863d30
                domain_name:
                    description: Domain name
                    type: string
                    example: mydomain.example
                auto_enrollment_enabled:
                    description: Enable or disable host vm auto-enrollment for this domain
                    type: boolean
                    example: "true"
                title:
                    description: Title to describe the domain.
                    type: string
                description:
                    description: Human readable description abou the domain.
                    type: string
                domain_type:
                    description: Type of this domain. Currently only rhel-idm is supported.
                    enum:
                        - rhel-idm
                    type: string
                    example: rhel-idm
                rhel-idm:
                    $ref: "#/components/schemas/DomainIpa"
            additionalProperties: false
            example:
                domain_uuid: 1aa15eae-a88b-11ed-a2cb-482ae3863d30
                domain_name: mydomain.example
                domain_description: My awesome domain description.
                domain_type: rhel-idm
                auto_enrollment_enabled: true
                ipa:
                    realm_name: IPA.EXAMPLE
                    ca_list: []
                    server_list:
                        - server1.mydomain.example
                        - Server2.mydomain.example
                    client_options: {}
        DomainIpa:
            title: Root Type for ResponseIpaObject
            description: Options for ipa domains
            required:
                - ca_certs
                - servers
                - realm_name
                - realm_domains
            type: object
            properties:
                servers:
                    description: List of auto-enrollment enabled servers for this domain.
                    type: array
                    items:
                        $ref: "#/components/schemas/DomainIpaServer"
                ca_certs:
                    description: A base64 representation of all the list of chain of certificates,
                        including the server ca.
                    type: array
                    items:
                        $ref: "#/components/schemas/DomainIpaCert"
                    example: >-
                        [
                          {
                            "nickname": "MYDOMAIN.EXAMPLE IPA CA",
                            "issuer": "CN=Certificate Authority,O=MYDOMAIN.EXAMPLE",
                            "subject": "CN=Certificate Authority,O=MYDOMAIN.EXAMPLE",
                            "serial_number": "1",
                            "not_valid_before": "2023-01-31T13:23:36Z",
                            "not_valid_after": "2023-01-31T13:23:36Z"
                            "pem": "-----BEGIN CERTIFICATE-----\nMIIE...\n-----END CERTIFICATE-----\n",
                          }
                        ]
                realm_name:
                    description: The kerberos realm name associated to this IPA domain.
                    type: string
                    example: MYDOMAIN.EXAMPLE
                realm_domains:
                    description: List of realm associated to the IPA domain.
                    type: array
                    items:
                        type: string
            additionalProperties: false
        DomainIpaServer:
            title: Root Type for CreateDomainIpaServer
            description: Server schema for an entry into the Ipa domain type.
            required:
                - ca_server
                - fqdn
                - hcc_enrollment_server
                - hcc_update_server
                - pkinit_server
                - subscription_manager_id
                - location
            type: object
            properties:
                fqdn:
                    type: string
                    example: server1.mydomain.example
                ca_server:
                    type: boolean
                    example: "true"
                hcc_enrollment_server:
                    type: boolean
                    example: "true"
                hcc_update_server:
                    type: boolean
                    example: "true"
                pkinit_server:
                    type: boolean
                    example: "true"
                subscription_manager_id:
                    type: string
                    example: 03965a2c-bd24-11ed-968d-482ae3863d30
                location:
                    description: A location identifier (lower-case DNS label).
                    maxLength: 63
                    type: string
            additionalProperties: false
            example:
                fqdn: ipaserver.mydomain.example
                rhsm_id: 03965a2c-bd24-11ed-968d-482ae3863d30
                location: europe
                ca_server: true
                hcc_enrollment_server: true
                hcc_update_server: true
                pkinit_server: true
        ResponseDomain:
            title: Root Type for DomainResponse
            description: A domain resource
            type: object
            allOf:
                - type: object
                - $ref: "#/components/schemas/Domain"
            additionalProperties: false
            example:
                domain_uuid: 1aa15eae-a88b-11ed-a2cb-482ae3863d30
                domain_name: mydomain.example
                domain_description: My awesome domain description.
                auto_enrollment_enabled: true
                domain_type: rhel-idm
        HostConfIpa:
            title: Root Type for ResponseIpaObject
            description: Options for ipa domains
            required:
                - ca_certs
            type: object
            properties:
                realm_name:
                    description: The realm name for the domain
                    type: string
                    example: IPA.EXAMPLE
                server_list:
                    description: List of auto-enrollment enabled servers for this domain.
                    type: array
                    items:
                        type: string
                    example: '["server1.mydomain.example","server2.mydomain.example"]'
                ca_certs:
                    description: List of certificate data.
                    type: array
                    items:
                        $ref: "#/components/schemas/CreateDomainIpaCert"
                realm_domains:
                    description: List of certificate data.
                    type: array
                    items:
                        type: string
                    example: '["mydomain.example"]'
            example:
                realm_name: IPA.EXAMPLE
                ca_list: base64
                server_list:
                    - server1.mydomain.example
                    - server2.mydomain.example
        UpdateDomain:
            title: Root Type for DomainResponse
            description: Update a domain resource
            type: object
            allOf:
                - type: object
                - $ref: "#/components/schemas/Domain"
            additionalProperties: false
    responses:
        ErrorResponse:
            content:
                application/json:
                    schema:
                        $ref: "#/components/schemas/Errors"
            description: Error response for some operation.
        ReadDomainResponse:
            content:
                application/json:
                    schema:
                        $ref: "#/components/schemas/Domain"
            description: This represent the response for a specific domain.
        ListDomainsResponse:
            content:
                application/json:
                    schema:
                        $ref: "#/components/schemas/ListDomainsResponseSchema"
            description: It represent the response for a list of domains query.
        HostConfResponse:
            content:
                application/json:
                    schema:
                        $ref: "#/components/schemas/HostConfResponseSchema"
            description: Response for the HostConf action.
        RegisterDomainResponse:
            content:
                application/json:
                    schema:
                        $ref: "#/components/schemas/Domain"
            description: Response for the domain register operation.
        CreateDomainResponse:
            headers:
                X-Rh-Idm-Rhel-Idm-Token:
                    schema:
                        type: string
            content:
                application/json:
                    schema:
                        $ref: "#/components/schemas/Domain"
            description: Response when a domain has been created.
        UpdateDomainResponse:
            content:
                application/json:
                    schema:
                        $ref: "#/components/schemas/Domain"
            description: Response for the domain update operation.
    securitySchemes:
        x-rh-identity:
            type: apiKey
            description: Require a valid X-Rh-Identity
            name: X-Rh-Identity
            in: header
security:
    - x-rh-identity: []
tags:
    - name: resources
      description: CRUD operation on defined resources
    - name: actions
      description: Endpoints no directly related with resources but model actions with
          the API
